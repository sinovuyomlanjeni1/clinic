<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <title>Edit Appointment</title>
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<header class="main-header">
  <div class="logo">
    <h1>Clinic System</h1>
    <p>Edit Appointment</p>
  </div>

  <nav class="nav-links">
    <a th:href="@{/}" class="nav-btn">Dashboard</a>
    <a th:href="@{/patients}" class="nav-btn">Patients</a>
    <a th:href="@{/doctors}" class="nav-btn">Doctors</a>
    <a th:href="@{/appointments}" class="nav-btn active">Appointments</a>
  </nav>
</header>

<main class="container">

  <div class="form-box">
    <h2>Edit Appointment</h2>

    <p th:if="${error}" class="error-message" th:text="${error}"></p>

    <form th:action="@{/appointments/update}" method="post">

      <input type="hidden" name="id" th:value="${appointment.id}">

      <div class="form-group">
        <label>Select Patient</label>
        <select name="patientId" required>
          <option th:each="patient : ${patients}"
                  th:value="${patient.id}"
                  th:selected="${patient.id == appointment.patient.id}"
                  th:text="${patient.name}">
          </option>
        </select>
      </div>

      <div class="form-group">
        <label>Select Doctor</label>
        <select name="doctorId" required>
          <option th:each="doctor : ${doctors}"
                  th:value="${doctor.id}"
                  th:selected="${doctor.id == appointment.doctor.id}"
                  th:text="${doctor.name + ' - ' + doctor.specialization}">
          </option>
        </select>
      </div>

      <div class="form-group">
        <label>Date & Time</label>
        <input type="datetime-local" name="dateTime"
               th:value="${#temporals.format(appointment.dateTime, 'yyyy-MM-dd''T''HH:mm')}"
               required>
      </div>

      <div class="form-group">
        <label>Status</label>
        <select name="status" required>
          <option value="BOOKED" th:selected="${appointment.status == 'BOOKED'}">BOOKED</option>
          <option value="COMPLETED" th:selected="${appointment.status == 'COMPLETED'}">COMPLETED</option>
          <option value="CANCELLED" th:selected="${appointment.status == 'CANCELLED'}">CANCELLED</option>
        </select>
      </div>

      <div class="form-actions">
        <button type="submit" class="btn-primary">Update Appointment</button>
        <a th:href="@{/appointments}" class="btn-danger">Cancel</a>
      </div>

    </form>
  </div>

</main>

</body>
</html>
